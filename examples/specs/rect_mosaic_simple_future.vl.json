{
 "$schema": "https://vega.github.io/schema/vega-lite/v2.json",
 "data": {
   "url": "data/cars.json"
 },
 "transform": [
   {
     "aggregate": [
       {
         "op": "count",
         "as": "count_*"
       }
     ],
     "groupby": [
       "Origin",
       "Cylinders"
     ]
   },
   {
     "stack": "count_*",
     "groupby": [],
     "as": [
       "stack_count_Origin1",
       "stack_count_Origin2"
     ],
     "offset": "normalize",
     "sort": [{
       "field": "Origin",
       "order": "ascending"
     }]
   },
   {
     "window": [
       {
         "op": "min",
         "field": "stack_count_Origin1",
         "as": "x"
       },
       {
         "op": "max",
         "field": "stack_count_Origin2",
         "as": "x2"
       }
     ],
     "groupby": [
       "Origin"
     ],
     "frame": [
       null,
       null
     ]
   },
   {
     "stack": "count_*",
     "groupby": [
       "Origin"
     ],
     "as": [
       "y",
       "y2"
     ],
     "offset": "normalize",
     "sort": [{
       "field": "Cylinders",
       "order": "ascending"
     }]
   }
 ],
 "mark": {"type": "rect"},
 "encoding": {
   "y": {
     "field": "x",
     "type": "quantitative",
     "axis": null
   },
   "y2": {
     "field": "x2",
     "type": "quantitative"
   },
   "x": {
     "field": "y",
     "type": "quantitative",
     "axis": null
   },
   "x2": {
     "field": "y2",
     "type": "quantitative"
   },
   "color": {
     "field": "Origin",
     "type": "nominal"
   },
   "opacity": {
     "field": "Cylinders",
     "type": "quantitative",
     "legend": false
   },
   "tooltip": [{
     "field": "Origin",
     "type": "nominal"
   }, {
     "field": "Cylinders",
     "type": "quantitative"
   }]
 }
}
